<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Mosaic Puzzle</title>
<style>
:root{--primary:#5E3023;--secondary:#F3E9DC;--midtone:#C08552;--bg:#F3E9DC}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Palatino', Georgia,'Times New Roman',Times,serif}
body{background:var(--bg);min-height:100vh;display:flex;flex-direction:column}
button{transition:all .2s ease;cursor:pointer;border:none}
button:active{transform:scale(.95)}

/* Shared */
.hidden{display:none!important}
.page{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1rem}

/* Selected cell pulsing animation - stays within bounds */
.cell-g.selected polygon {
    animation: gentlePulse 0.8s ease-in-out infinite;
    stroke: var(--primary) !important;
    stroke-width: 3;
}

@keyframes gentlePulse {
    0%, 100% {
        opacity: 0.85;
        stroke-width: 3;
    }
    50% {
        opacity: 1;
        stroke-width: 4;
    }
}

/* Interactive cells have subtle hover effect */
.cell-g.interactive polygon {
    cursor: pointer;
    transition: opacity 0.15s ease, filter 0.15s ease;
}

.cell-g.interactive:hover polygon {
    opacity: 0.9;
    filter: brightness(1.1);
}

.cell-g.interactive:active polygon {
    opacity: 0.7;
}

/* Home */
#home .title{font-size:15vw;font-weight:700;color:var(--primary);font-style:italic;margin-bottom:.5rem}
#home .subtitle{font-size:1rem;color:var(--primary);margin-bottom:2rem}
.upload-label{width:16rem;height:16rem;background:var(--primary);border-radius:1rem;border:4px solid var(--primary);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}
.upload-label:hover{background:var(--secondary)}
.upload-label p{margin-top:1rem;color:var(--secondary);font-size:.875rem}
.preview-wrap{display:flex;flex-direction:column;align-items:center;gap:1rem;position:relative}
.preview-img{width:16rem;height:16rem;border-radius:1rem;object-fit:cover;border:1px solid var(--primary)}
.change-btn{padding:.5rem 1.5rem;color:var(--primary);background:none;border-radius:.5rem; border: 2px solid var(--primary);}
.change-btn:hover{background:var(--bg)}
.diff-btns{margin-top: 4rem;display:flex;flex-direction:column;align-items:center;gap:1rem;margin-top:2rem}
.diff-btn{width:16rem;height:4rem;background:var(--primary);opacity:1;color:#fff;font-size:1.25rem;border-radius:.5rem;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,.15)}
.diff-btn:disabled{opacity:.5;cursor:not-allowed}


/* Loading */
/* Loading overlay styles */
#loading {
  position: absolute;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(243,233,220,0.7);
  z-index: 2;
  margin: 0;
  border-radius: 1rem;
}
#loading .dots{display:flex;gap:.75rem;justify-content:center;}
#loading .dot{width:1rem;height:1rem;background:var(--primary);border-radius:50%;animation:bounce 1s ease-in-out infinite}
#loading .dot:nth-child(2){animation-delay:.15s}
#loading .dot:nth-child(3){animation-delay:.3s}
#loading h2{font-size:1.875rem;font-weight:700;color:var(--primary)}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}
.zoom-in{animation:zoomIn .5s ease-out}
@keyframes zoomIn{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}

/* Game */
#game{justify-content:flex-start;gap:1rem;padding:1rem;overflow:hidden;position:relative}
.mosaic-wrap{width:95vw}
.mosaic-svg{display:block;width:100%;height:auto}
.mosaic-label{text-align:center;margin-top:.5rem;color:var(--primary);font-weight:600}
.hint-btn{margin:1rem;padding:1rem;background:#fff;border:2px solid var(--primary);color:var(--primary);border-radius:.5rem;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,.1)}
.hint-btn:hover{background:var(--secondary)}

/* Cell animations */
.cell-g{transform-box:fill-box;transform-origin:center}
.cell-g.interactive{cursor:pointer;transition:transform .15s ease}
.cell-g.selected{transform:scale(.8)}

/* Intro animations */
.pop-in{animation:pop .5s cubic-bezier(.68,-.55,.265,1.55)}
@keyframes pop{0%{transform:scale(0) translateY(50%);opacity:0}70%{transform:scale(1.1) translateY(50%)}100%{transform:scale(1) translateY(50%);opacity:1}}
.glide-up{animation:glideUp .8s ease-in forwards}
@keyframes glideUp{from{bottom:50%;transform:translateY(50%); width:95vw; }to{bottom:auto;position:relative;transform:translateY(0); width:40vw;}}
.fade-in{animation:fadeIn 1s ease-in}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.welcome-in{animation:sideSlide 1s ease-in-out forwards}
@keyframes sideSlide{from{transform:translateX(20%); opacity:0}to{transform:translateX(0); opacity:1}}

/* Win */
#win{position:relative;overflow:hidden}
.win-badge{background:#fff;padding:3rem;border-radius:1.5rem;border:3px solid var(--primary);box-shadow:0 10px 40px rgba(94,48,35,.2);animation:scaleIn .5s cubic-bezier(.68,-.55,.265,1.55);text-align:center;z-index:10}
@keyframes scaleIn{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}
.win-badge h1{font-size:3rem;font-weight:700;color:var(--primary);margin:.5rem 0}
.win-badge p{font-size:1.125rem;color:var(--primary);opacity:.8}
.win-btns{display:flex;flex-direction:column;gap:1rem;margin-top:2rem;z-index:10}
.win-btn{padding:1rem 2rem;font-size:1.125rem;border-radius:.5rem;font-weight:600}
.win-btn.primary{background:var(--primary);color:#fff;box-shadow:0 4px 12px rgba(0,0,0,.15)}
.win-btn.secondary{background:#fff;border:2px solid var(--primary);color:var(--primary)}
#confetti{position:absolute;inset:0;pointer-events:none}
.confetti{position:absolute;width:10px;height:10px;top:-10px;opacity:0;animation:fall linear infinite}
@keyframes fall{0%{top:-10px;opacity:1;transform:rotate(0)}100%{top:100vh;opacity:.5;transform:rotate(360deg)}}
</style>
</head>
<body>

<!-- HOME PAGE -->
<div id="home" class="page">
  <div style="text-align:center">
    <button id="win-btn">WIN</button>
    <h1 class="title welcome-in">SliceSwap!</h1>
    <p class="subtitle fade-in">Create your mosaic</p>
  </div>
  <!-- LOADING PAGE -->

  <div id="upload-area">
    <label class="upload-label">
      <input type="file" accept="image/*" id="file-input" style="display:none">
      <svg viewBox="0 0 24 24" style="width:6rem;height:6rem">
        <path d="M15.24,6.63a1.09,1.09,0,0,0-2,0l-2.8,5.53v0L9,8.9a1,1,0,0,0-1.8,0L3,18H21Z" fill="none" stroke="var(--secondary)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
      </svg>
      <p><b>Tap to upload</b></p>
    </label>
  </div>
  <div id="preview-area" class="hidden">
    <div class="preview-wrap">
      <img id="preview-img" class="preview-img" alt="Preview">
      <div id="loading" class="fade-in" hidden>
        <div class="dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
      </div>
      <button class="change-btn" id="change-btn">Change Image</button>
    </div>
  </div>
  <div class="diff-btns">
    <button class="diff-btn" id="btn-easy" disabled>Easy</button>
    <button class="diff-btn" id="btn-medium" disabled>Medium</button>
    <button class="diff-btn" id="btn-hard" disabled>Extreme</button>
  </div>
</div>



<!-- GAME PAGE -->
<div id="game" class="page hidden">
  <div class="mosaic-wrap glide-up shrink" id="original-wrap">
    <svg class="mosaic-svg" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet" id="original-svg"></svg>
    <div class="mosaic-label">Original</div>
  </div>
  <div class="mosaic-wrap" id="scrambled-wrap" style="display:none">
    <svg class="mosaic-svg" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet" id="scrambled-svg"></svg>
    <!-- <div class="mosaic-label">Your Puzzle</div> -->
  </div>
  <button class="hint-btn hidden" id="hint-btn">Show Differences</button>
</div>

<!-- WIN PAGE -->
<div id="win" class="page hidden">
  <div id="confetti"></div>
  <div class="win-badge">
    <div style="font-size:3.75rem;margin-bottom:1rem">ðŸŽ‰</div>
    <h1>You Won!</h1>
    <p>Puzzle completed successfully</p>
  </div>
  <div class="win-btns">
    <button class="win-btn primary" id="download-btn">Download Your Mosaic</button>
    <button class="win-btn secondary" id="play-again-btn">Play Again</button>
  </div>
</div>

<script src="mosaicGen.js"></script>
<script src="app.js"></script>
</body>
</html>