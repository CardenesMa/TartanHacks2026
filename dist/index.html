<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Mosaic Puzzle</title>
<style>
:root{--primary:#5E3023;--secondary:#F3E9DC;--midtone:#C08552;--bg:#F3E9DC}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Palatino', Georgia,'Times New Roman',Times,serif}
body{background:var(--bg);min-height:100vh;display:flex;flex-direction:column}
button{transition:all .2s ease;cursor:pointer;border:none}
button:active{transform:scale(.95)}

/* Shared */
.hidden{display:none!important}
.page{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1rem}

/* Selected cell pulsing animation - stays within bounds */
.cell-g.selected polygon {
    animation: gentlePulse 0.8s ease-in-out infinite;
    stroke: var(--primary) !important;
    stroke-width: 3;
}

@keyframes gentlePulse {
    0%, 100% {
        opacity: 0.85;
        stroke-width: 3;
    }
    50% {
        opacity: 1;
        stroke-width: 4;
    }
}

/* Interactive cells have subtle hover effect */
.cell-g.interactive polygon {
    cursor: pointer;
    transition: opacity 0.15s ease, filter 0.15s ease;
}

.cell-g.interactive:hover polygon {
    opacity: 0.9;
    filter: brightness(1.1);
}

.cell-g.interactive:active polygon {
    opacity: 0.7;
}

/* Home */
#home .title{font-size:15vw;font-weight:700;color:var(--primary);font-style:italic;margin-bottom:.5rem}
#home .subtitle{font-size:1rem;color:var(--primary);margin-bottom:2rem}
.upload-label{width:16rem;height:16rem;background:var(--primary);border-radius:1rem;border:4px solid var(--primary);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}
.upload-label:hover{background:var(--secondary)}
.upload-label p{margin-top:1rem;color:var(--secondary);font-size:.875rem}
.preview-wrap{display:flex;flex-direction:column;align-items:center;gap:1rem;position:relative}
.preview-img{width:16rem;height:16rem;border-radius:1rem;object-fit:cover;border:1px solid var(--primary)}
.change-btn{padding:.5rem 1.5rem;color:var(--primary);background:none;border-radius:.5rem; border: 2px solid var(--primary);}
.change-btn:hover{background:var(--bg)}
.diff-btns{margin-top: 4rem;display:flex;flex-direction:column;align-items:center;gap:1rem;margin-top:2rem}
.diff-btn{width:16rem;height:4rem;background:var(--primary);opacity:1;color:#fff;font-size:1.25rem;border-radius:.5rem;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,.15)}
.diff-btn:disabled{opacity:.5;cursor:not-allowed}


/* Loading */
/* Loading overlay styles */
#loading {
  position: absolute;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(243,233,220,0.7);
  z-index: 2;
  margin: 0;
  border-radius: 1rem;
}
#loading .dots{display:flex;gap:.75rem;justify-content:center;}
#loading .dot{width:1rem;height:1rem;background:var(--primary);border-radius:50%;animation:bounce 1s ease-in-out infinite}
#loading .dot:nth-child(2){animation-delay:.15s}
#loading .dot:nth-child(3){animation-delay:.3s}
#loading h2{font-size:1.875rem;font-weight:700;color:var(--primary)}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}
.zoom-in{animation:zoomIn .5s ease-out}
@keyframes zoomIn{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}

/* Game */
#game{justify-content:flex-start;gap:1rem;padding:1rem;overflow:hidden;position:relative}
.mosaic-wrap{width:95vw}
.mosaic-svg{display:block;width:100%;height:auto}
.mosaic-label{text-align:center;margin-top:.5rem;color:var(--primary);font-weight:600}
.hint-btn{margin:1rem;padding:1rem;background:#fff;border:2px solid var(--primary);color:var(--primary);border-radius:.5rem;font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,.1)}
.hint-btn:hover{background:var(--secondary)}

/* Cell animations */
.cell-g{transform-box:fill-box;transform-origin:center}
.cell-g.interactive{cursor:pointer;transition:transform .15s ease}
.cell-g.selected{transform:scale(.8)}

/* Intro animations */
.pop-in{animation:pop .5s cubic-bezier(.68,-.55,.265,1.55)}
@keyframes pop{0%{transform:scale(0) translateY(50%);opacity:0}70%{transform:scale(1.1) translateY(50%)}100%{transform:scale(1) translateY(50%);opacity:1}}
.glide-up{animation:glideUp .8s ease-in forwards}
@keyframes glideUp{from{bottom:50%;transform:translateY(50%); width:95vw; }to{bottom:auto;position:relative;transform:translateY(0); width:40vw;}}
.fade-in{animation:fadeIn 1s ease-in}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}

/* Title entrance */
#home .title {
  overflow: hidden;
  display: inline-block;
}

.slice,
.swap {
  display: inline-block;
  opacity: 0;
}

/* Slice enters first */
.slice {
  animation: sliceIn 1s cubic-bezier(.68,-.55,.265,1.55) forwards;
}

/* Swap enters slightly later */
.swap {
  animation: swapIn 1s ease-out forwards;
  animation-delay: .6s;
}

/* Slice overshoot */
@keyframes sliceIn {
  0% {
    transform: translateX(-120%);
    opacity: 0;
  }
  70% {
    transform: translateX(8%);
    opacity: 1;
  }
  85% {
    transform: translateX(-3%);
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}

/* Swap clean glide */
@keyframes swapIn {
  0% {
    transform: translateX(120%);
    opacity: 0;
  }
  100% {
    transform: translateX(0);
    opacity: 1;
  }
}

/* Background blobs */
#home {
  position: relative;
  overflow: hidden;
}

.bg-blob {
  position: absolute;
  width: 200px;
  height: 300px;
  border: 2px solid black;
  border-image: linear-gradient(to right, #451508, #665457);
  border-image-slice: 1;

  background: linear-gradient(
    to right,
    rgba(192,133,82,0.55),
    rgba(94,48,35,0.25)
  );


  filter: blur(8px);
  z-index: 0;
  opacity: 1;
  transition: opacity 1s ease;
  pointer-events: none;
}

.blob-top {
  top: 10%;
  right: 10%;
}

.blob-bottom {
  bottom: 10%;
  left: 10%;
}

/* Ensure content sits above blobs */
#home > *:not(.bg-blob) {
  position: relative;
  z-index: 2;
}


@keyframes sideSlide{from{transform:translateX(20%); opacity:0}to{transform:translateX(0); opacity:1}}

/* Win */
#win{position:relative;overflow:hidden}
.win-badge{background:#fff;padding:3rem;border-radius:1.5rem;border:3px solid var(--primary);box-shadow:0 10px 40px rgba(94,48,35,.2);animation:scaleIn .5s cubic-bezier(.68,-.55,.265,1.55);text-align:center;z-index:10}
@keyframes scaleIn{0%{transform:scale(0);opacity:0}100%{transform:scale(1);opacity:1}}
.win-badge h1{font-size:3rem;font-weight:700;color:var(--primary);margin:.5rem 0}
.win-badge p{font-size:1.125rem;color:var(--primary);opacity:.8}
.win-btns{display:flex;flex-direction:column;gap:1rem;margin-top:2rem;z-index:10}
.win-btn{padding:1rem 2rem;font-size:1.125rem;border-radius:.5rem;font-weight:600}
.win-btn.primary{background:var(--primary);color:#fff;box-shadow:0 4px 12px rgba(0,0,0,.15)}
.win-btn.secondary{background:#fff;border:2px solid var(--primary);color:var(--primary)}
#confetti{position:absolute;inset:0;pointer-events:none}
.confetti{position:absolute;width:10px;height:10px;top:-10px;opacity:0;animation:fall linear infinite}
@keyframes fall{0%{top:-10px;opacity:1;transform:rotate(0)}100%{top:100vh;opacity:.5;transform:rotate(360deg)}}
</style>
</head>
<body>

<!-- HOME PAGE -->
<div id="home" class="page">
  <div class="bg-blob blob-top"></div>
<div class="bg-blob blob-bottom"></div>
  <div style="text-align:center">
    <button id="win-btn">WIN</button>
    <h1 class="title">
  <span class="slice">Slice</span><span class="swap">Swap!</span>
</h1>
    <p class="subtitle fade-in">Create your mosaic...</p>
  </div>
  <!-- LOADING PAGE -->

  <div id="upload-area">
    <label class="upload-label">
      <input type="file" accept="image/*" id="file-input" style="display:none">
      <svg viewBox="0 0 24 24" style="width:6rem;height:6rem">
        <path d="M15.24,6.63a1.09,1.09,0,0,0-2,0l-2.8,5.53v0L9,8.9a1,1,0,0,0-1.8,0L3,18H21Z" fill="none" stroke="var(--secondary)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
      </svg>
      <p><b>Tap to upload</b></p>
    </label>
  </div>
  <div id="preview-area" class="hidden">
    <div class="preview-wrap">
      <img id="preview-img" class="preview-img" alt="Preview">
      <div id="loading" class="fade-in" hidden>
        <div class="dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
      </div>
      <button class="change-btn" id="change-btn">Change Image</button>
    </div>
  </div>
  <div class="diff-btns">
    <button class="diff-btn" id="btn-easy" disabled>Easy</button>
    <button class="diff-btn" id="btn-medium" disabled>Medium</button>
    <button class="diff-btn" id="btn-hard" disabled>Extreme</button>
  </div>
</div>



<!-- GAME PAGE -->
<div id="game" class="page hidden">
  <div class="mosaic-wrap glide-up shrink" id="original-wrap">
    <svg class="mosaic-svg" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet" id="original-svg"></svg>
    <div class="mosaic-label">Original</div>
  </div>
  <div class="mosaic-wrap" id="scrambled-wrap" style="display:none">
    <svg class="mosaic-svg" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid meet" id="scrambled-svg"></svg>
    <!-- <div class="mosaic-label">Your Puzzle</div> -->
  </div>
  <button class="hint-btn hidden" id="hint-btn">Show Differences</button>
</div>

<!-- WIN PAGE -->
<div id="win" class="page hidden">
  <div id="confetti"></div>
  <div class="win-badge">
    <div style="font-size:3.75rem;margin-bottom:1rem"><svg viewBox="-5.5 0 157 157" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g clip-path="url(#clip0)"> <path d="M84.2177 81.107C85.8205 86.8648 88.6698 91.5132 91.7408 96.1537C94.3495 100.096 97.4537 101.524 102.19 101.244C108.946 100.844 109.993 102.139 110.513 108.969C110.898 114.041 111.255 119.115 111.655 124.591C113.151 124.591 114.451 124.591 115.758 124.591C120.039 124.591 123.332 127.569 123.509 131.652C123.662 135.194 124.128 138.723 124.457 142.255C124.723 145.114 125.168 147.97 125.213 150.833C125.278 155.154 123.684 156.579 119.325 156.464C107.204 156.139 95.0868 155.591 82.966 155.524C67.5069 155.439 52.0455 155.742 36.5851 155.877C34.3601 155.896 32.1323 155.993 29.9104 155.91C26.1944 155.772 24.0929 153.63 24.2964 149.942C24.6215 144.078 25.1254 138.223 25.5969 132.367C25.8036 129.795 26.9469 127.951 29.7298 127.506C32.4451 127.071 35.1553 126.602 38.3459 126.069C38.5371 123.941 38.8011 121.555 38.9552 119.161C39.1795 115.618 39.2958 112.069 39.5065 108.525C39.7939 103.706 41.5156 101.731 46.2961 101.064C49.042 100.679 51.8328 100.588 54.6066 100.431C55.7478 100.366 56.7927 100.359 57.4169 99.1335C60.1316 93.8 63.2359 88.6417 64.7873 82.7899C64.9439 82.0062 65.0525 81.2141 65.1124 80.4174C64.2834 80.119 63.5817 79.8374 62.8619 79.6123C55.4895 77.3027 48.9705 72.8613 44.131 66.8512C42.8773 65.3337 41.4612 64.8244 39.6126 64.5053C29.2773 62.7225 19.7014 59.0601 11.4696 52.4104C6.11367 48.0838 2.49642 42.6517 1.33902 35.7372C-0.586294 24.1932 8.66307 12.8406 20.3606 12.5195C24.2385 12.4131 28.1223 12.5026 32.1063 12.5026C32.6563 10.3013 33.0634 8.4802 33.568 6.69221C34.3775 3.82146 35.7476 1.62479 39.2633 1.6968C40.6808 1.72729 42.1055 1.1292 43.5301 1.11298C64.7759 0.868615 86.0221 0.660473 107.268 0.48877C108.597 0.508304 109.919 0.671242 111.212 0.974707C114.149 1.59687 115.763 3.57496 116.436 6.39382C116.696 7.47144 116.886 8.56466 117.171 9.96599C118.024 9.96599 118.874 9.97637 119.724 9.96599C123.505 9.90954 127.286 9.80444 131.067 9.79601C139.346 9.7772 146.176 16.0818 145.409 25.8761C143.965 44.3249 129.757 58.6314 113.921 61.4223C113.817 61.4599 113.707 61.4817 113.595 61.4872C109.373 60.8326 107.6 63.492 105.558 66.6306C100.645 74.1718 93.6381 79.068 84.2177 81.107ZM40.0586 7.26195C39.9058 8.17671 39.79 8.70992 39.7295 9.25034C38.3224 22.4145 39.6505 35.7266 43.6309 48.3556C47.8938 62.2254 57.2114 70.9851 72.0949 72.897C81.5466 74.1121 90.1204 72.3462 96.4946 64.6435C98.533 62.1606 100.247 59.4292 101.595 56.5151C108.357 41.9394 110.203 26.6001 108.234 10.7398C108.104 9.683 107.793 8.64835 107.492 7.26195H40.0586ZM31.4281 133.914C31.9196 139.121 32.3735 143.93 32.8436 148.919C34.3391 148.919 35.4276 148.961 36.5141 148.913C45.3929 148.524 54.2692 147.86 63.1506 147.771C79.7116 147.606 96.2755 147.771 112.839 147.792C113.792 147.792 114.745 147.698 115.808 147.641C116.31 142.641 116.78 137.95 117.278 132.979L31.4281 133.914ZM100.239 124.813C100.709 119.499 101.727 114.569 101.734 109.335C83.297 108.949 65.2781 107.382 46.8092 108.254C47.4594 114.312 48.0784 120.062 48.6993 125.842L100.239 124.813ZM31.7826 18.8449C27.6497 19.4243 23.942 20.0016 20.2189 20.4486C16.4599 20.9027 13.9703 22.9788 12.1965 26.181C9.2945 31.4263 9.87775 36.5392 13.3018 41.1402C19.0706 48.8961 27.5241 52.3086 36.9758 55.0282C32.8423 43.1098 31.988 31.2583 31.7826 18.8449ZM112.731 51.362C122.604 48.388 129.097 42.6738 132.993 34.2347C134.397 30.9962 135.318 27.5694 135.724 24.0641C136.179 20.712 134.583 18.6794 131.633 18.2207C127.036 17.5109 122.409 18.0261 117.533 17.9612C118.154 29.3018 116.522 40.6527 112.731 51.362ZM76.7739 81.8194L72.1671 81.5806C69.9979 87.8613 67.925 93.861 65.749 100.16H83.8672L76.7739 81.8194Z" fill="#5E3023"></path> </g> <defs> <clipPath id="clip0"> <rect width="145" height="157" fill="white" transform="translate(0.777344)"></rect> </clipPath> </defs> </g></svg></div>
    <h1>You Won!</h1>
    <p>Nice work, puzzler!</p>
  </div>
  <div class="win-btns">
    <button class="win-btn primary" id="download-btn">Download Your Mosaic</button>
    <button class="win-btn secondary" id="play-again-btn">Play Again</button>
  </div>
</div>

<script src="mosaicGen.js"></script>
<script src="app.js"></script>
</body>
</html>